function DTFORM(s,o,t,e,a){return this.classActionInsert=".action-insert-record",this.classActionUpdate=".action-update-record",this.classActionDelete=".action-delete-record",this.classActionClose=".btn-close-form",this.classDoButton=".btn-do-action",this.classSourceControls=".data-source",this.inputTypeCheckbox=".input_label",this.idMessageBox="#dt-action-message",this.messageBoxHtml='<div  class="alert alert-:type: alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button><h4><i class="icon fa fa-:icon:"></i>:caption:</h4>:message:</div>',this.formid=s,this.loadformurl=o,this.model=t,this.doactionurl=e,this.dt=a,this.record_id=null,this.refresh=1,this.aftershow=function(){},this.afterEmptyControls=function(){},this.afterdatasource=function(s){return s},this.disablecontrols=function(s){var o=$(this.classSourceControls);o.prop("disabled","delete"==s),o.css({"background-color":"delete"==s?"#eee":"#fff"})},this.fillfields=function(s,o){for(field in s){var t=$(this.classSourceControls+'[data-control-source="'+field+'"]');if(t.length>0)switch(t.data("control-type")){case"textbox":case"editbox":if(t.hasClass("to-float"))s[field]=numeral(s[field]).format();else if(t.hasClass("moment")){var e=moment(s[field],"YYYY-MM-DD");s[field]=e.format("DD.MM.YYYY"),console.log("11.05 Moment> "+field+" = "+s[field])}t.val(s[field]);break;case"combobox":null===s[field]&&(s[field]=0),t.hasClass("init-on-update-delete")&&t.val(s[field]).trigger("change");break;case"select2":t.val(s[field]).trigger("change");break;case"checkbox":t.prop("checked",s[field]==t.data("on")).iCheck("update")}}this.disablecontrols(o)},this.showform=function(s){this.hideFieldsErrors(),$(this.formid+" "+this.classDoButton).removeClass("btn-do-insert"),$(this.formid+" "+this.classDoButton).removeClass("btn-do-update"),$(this.formid+" "+this.classDoButton).removeClass("btn-do-delete"),$(this.formid+" "+this.classDoButton).addClass("btn-do-"+s.action).attr("data-action",s.action),$(this.formid+" #action-title").html(s.caption),$(this.formid+" "+this.classDoButton).html(s.button),$(this.formid+" .box-solid").show(),("update"==s.action||"delete"==s.action)&&this.fillfields(s.record,s.action),$(this.formid).show(),this.aftershow(s.record,s.action)},this.emptyControls=function(){var s=$(this.classSourceControls);s.each(function(){if(!$(this).hasClass("no-empty")){var s=$(this).closest(".form-group");switch($(this).data("control-type")){case"textbox":case"editbox":$(this).val("");break;case"combobox":break;case"select2":$(this).val([]).trigger("change")}s.removeClass("has-error"),s.find(".error-sign").remove(),s.find(".help-block").remove(),$(this).prop("disabled",!1),$(this).css({"background-color":"#fff"})}}),console.log("3.2. -----> Custom after Empty controls"),this.afterEmptyControls()},this.hideform=function(){$(this.formid+" "+this.classDoButton).removeClass("btn-do-insert"),$(this.formid+" "+this.classDoButton).removeClass("btn-do-update"),$(this.formid+" "+this.classDoButton).removeClass("btn-do-delete"),$(this.formid+" #action-title").html(""),$(this.formid+" "+this.classDoButton).html(""),console.log("3.1. -----> Empty controls"),this.emptyControls(),$(this.formid).hide()},this.loadform=function(s,o){var t=this;console.log("2 -----> Hide Action Message"),this.hideActionMessage(),console.log("3 -----> Hide form"),this.hideform(),$.ajax({url:this.loadformurl,type:"post",dataType:"json",data:{action:s,record_id:o,model:t.model},success:function(s){t.record_id=o,console.log("4 -----> Show form"),console.log(s),t.showform(s),$(t.classDoButton).removeClass("disabled")}})},this.tofloat=function(s){return numeral().unformat(s)},this.controlvalue=function(s){var o=null;switch(s.data("control-type")){case"textbox":case"persistent":case"combobox":case"select2":case"editbox":if(o=s.val(),s.hasClass("to-float"))o=this.tofloat(o);else if(s.hasClass("moment")){var t=moment(o,"DD.MM.YYYY");o=t.format("YYYY-MM-DD")}break;case"checkbox":o=s.prop("checked")?s.data("on"):s.data("off")}return o},this.datasource=function(){var s=this,o=new Object,t=$(this.classSourceControls);return t.each(function(){o[$(this).data("control-source")]=s.controlvalue($(this))}),o=this.afterdatasource(o)},this.message=function(s){if("object"==typeof s&&void 0!==s&&null!==s){for(result="",i=0;i<s.length;i++)result+=s[i]+"<br/>";return result}return s},this.showActionMessage=function(s){var o=this.message(s.message);if(o){var t=$(this.idMessageBox).html(this.messageBoxHtml.replace(":type:",s.success?"success":"danger").replace(":caption:",s.success?"Succes!":"Eroare!").replace(":icon:",s.success?"check":"ban").replace(":message:",o));t.show()}},this.hideActionMessage=function(){$(this.idMessageBox).html("").find(".close").trigger("click")},this.showFieldsErrors=function(s){for(field in s){var o=$(this.classSourceControls+'[data-control-source="'+field+'"]');switch(o.data("control-type")){case"textbox":case"combobox":case"editbox":case"select2":var t=o.closest(".form-group");t.length>0&&(t.find(".error-sign").remove(),t.find(".help-block").remove(),t.addClass("has-error").prepend('<label class="control-label error-sign" for="'+field+'"><i class="fa fa-times-circle-o"></i></label>').append('<p class="help-block has-error">'+s[field]+"</p>"));var t=o.closest(".input-group").parent();t.length>0&&(t.find(".error-sign").remove(),t.find(".help-block").remove(),t.addClass("has-error").prepend('<label class="control-label error-sign" for="'+field+'"><i class="fa fa-times-circle-o"></i></label>').append('<p class="help-block has-error">'+s[field]+"</p>"))}}},this.hideFieldsErrors=function(){var s=$(this.classSourceControls);s.each(function(){var s=$(this).closest(".form-group");s.length>0&&(s.removeClass("has-error"),s.find(".error-sign").remove(),s.find(".help-block").remove());var s=$(this).closest(".input-group").parent();s.length>0&&(s.removeClass("has-error"),s.find(".error-sign").remove(),s.find(".help-block").remove())})},this.doaction=function(s){this.hideActionMessage(),this.hideFieldsErrors();var o=this;$.ajax({url:this.doactionurl,type:"post",dataType:"json",data:{action:s,model:o.model,data:o.datasource(),record_id:o.record_id,code:o.formid.replace("#form-","")},success:function(s){o.showActionMessage(s),s.success?1==o.refresh?(o.hideform(),o.dt.draw(!1)):2==o.refresh&&location.reload():(o.showFieldsErrors(s.fieldserrors),$(o.classDoButton).removeClass("disabled"))}})},this.bindActions=function(){var s=this;$(this.classActionInsert).on("click",function(){console.log("1 -----> Click on [Add] => load form"),s.loadform("insert",null)}),$(document).on("click",this.classActionUpdate,function(){s.loadform("update",$(this).data("id"))}),$(document).on("click",this.classActionDelete,function(){s.loadform("delete",$(this).data("id"))}),$(document).on("click",this.classActionClose,function(){s.hideform()}),$(document).find(".input-group > "+this.inputTypeCheckbox).closest(".input-group").on("mouseover mouseout click",this,function(s){var o=$(this).siblings("label");switch(s.type){case"click":o.click();break;case"mouseover":o.mouseover();break;default:o.mouseout()}}),$(document).on("click",this.classDoButton,function(){$(this).hasClass("disabled")||(s.doaction($(this).attr("data-action")),$(this).addClass("disabled"))})},this.bindActions(),this}